'use strict';

Object.defineProperty(exports, "__esModule", {
    value: true
});
exports.default = resolve;
var resolvers = require('require-all')(__dirname + '/resolvers');

function match(ext, cb) {
    var typeResolver = resolvers[Object.keys(resolvers).find(function (resolver) {
        if (resolvers[resolver].types.indexOf(ext) !== -1) {
            return true;
        }
        return false;
    })];

    var error = undefined;
    if (!typeResolver) {
        error = new Error('No resolver was found for file type ' + ext);
    }
    cb(error, typeResolver);
}

function resolve(file, ext, cb) {
    match(ext, function (err, resolver) {
        if (err) {
            cb(err);
        } else {
            resolver.resolve(file, function (err, contents) {
                if (err) {
                    cb(err);
                } else {
                    cb(undefined, contents);
                }
            });
        }
    });
}